<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EcoCart - Sustainable Shopping</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary-50: #f0f9ff;
        --primary-100: #e0f2fe;
        --primary-500: #0ea5e9;
        --primary-600: #0284c7;
        --primary-700: #0369a1;
        --primary-900: #0c4a6e;

        --gray-50: #f8fafc;
        --gray-100: #f1f5f9;
        --gray-200: #e2e8f0;
        --gray-300: #cbd5e1;
        --gray-400: #94a3b8;
        --gray-500: #64748b;
        --gray-600: #475569;
        --gray-700: #334155;
        --gray-800: #1e293b;
        --gray-900: #0f172a;

        --success-50: #f0fdf4;
        --success-100: #dcfce7;
        --success-500: #22c55e;
        --success-600: #16a34a;
        --success-700: #15803d;

        --warning-50: #fffbeb;
        --warning-100: #fef3c7;
        --warning-500: #f59e0b;
        --warning-600: #d97706;

        --danger-50: #fef2f2;
        --danger-100: #fee2e2;
        --danger-500: #ef4444;
        --danger-600: #dc2626;

        --background: #ffffff;
        --surface: #ffffff;
        --surface-hover: #f8fafc;
        --border: #e2e8f0;
        --border-light: #f1f5f9;
        --text-primary: #0f172a;
        --text-secondary: #475569;
        --text-tertiary: #94a3b8;

        --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow-sm:
          0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        --shadow-md:
          0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg:
          0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

        --radius-sm: 6px;
        --radius: 8px;
        --radius-md: 12px;
        --radius-lg: 16px;
        --radius-xl: 20px;
      }

      [data-theme="dark"] {
        --primary-50: #0c1a2e;
        --primary-100: #1e293b;
        --primary-500: #38bdf8;
        --primary-600: #0ea5e9;
        --primary-700: #0284c7;
        --primary-900: #0c4a6e;

        --gray-50: #0f172a;
        --gray-100: #1e293b;
        --gray-200: #334155;
        --gray-300: #475569;
        --gray-400: #64748b;
        --gray-500: #94a3b8;
        --gray-600: #cbd5e1;
        --gray-700: #e2e8f0;
        --gray-800: #f1f5f9;
        --gray-900: #f8fafc;

        --background: #0f172a;
        --surface: #1e293b;
        --surface-hover: #334155;
        --border: #334155;
        --border-light: #475569;
        --text-primary: #f8fafc;
        --text-secondary: #cbd5e1;
        --text-tertiary: #94a3b8;

        --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.3);
        --shadow-sm:
          0 1px 3px 0 rgb(0 0 0 / 0.3), 0 1px 2px -1px rgb(0 0 0 / 0.3);
        --shadow-md:
          0 4px 6px -1px rgb(0 0 0 / 0.3), 0 2px 4px -2px rgb(0 0 0 / 0.3);
        --shadow-lg:
          0 10px 15px -3px rgb(0 0 0 / 0.3), 0 4px 6px -4px rgb(0 0 0 / 0.3);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family:
          "Inter",
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          sans-serif;
        background: var(--gray-50);
        color: var(--text-primary);
        line-height: 1.6;
        font-weight: 400;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        transition: all 0.2s ease;
      }

      /* Header */
      .header {
        background: var(--background);
        border-bottom: 1px solid var(--border);
        position: sticky;
        top: 0;
        z-index: 50;
        backdrop-filter: blur(12px);
        transition: all 0.2s ease;
      }

      .header-content {
        max-width: 1280px;
        margin: 0 auto;
        padding: 0 24px;
        height: 72px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 20px;
        font-weight: 700;
        color: var(--text-primary);
        text-decoration: none;
        transition: color 0.2s ease;
      }

      .logo-icon {
        width: 32px;
        height: 32px;
        background: linear-gradient(
          135deg,
          var(--primary-500),
          var(--primary-600)
        );
        border-radius: var(--radius);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 18px;
        box-shadow: var(--shadow-sm);
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .stat-badge {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        font-size: 14px;
        font-weight: 500;
        color: var(--text-secondary);
        transition: all 0.2s ease;
      }

      .stat-badge:hover {
        border-color: var(--primary-500);
        background: var(--primary-50);
      }

      .stat-badge.coins {
        background: var(--warning-50);
        border-color: var(--warning-200);
        color: var(--warning-700);
      }

      .stat-badge.coins:hover {
        background: var(--warning-100);
      }

      .stat-dot {
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background: var(--success-500);
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }

      .stat-dot.warning {
        background: var(--warning-500);
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      .theme-toggle {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 14px;
        font-weight: 500;
        color: var(--text-secondary);
      }

      .theme-toggle:hover {
        border-color: var(--primary-500);
        background: var(--primary-50);
        color: var(--primary-600);
      }

      /* Main Layout */
      .main-container {
        max-width: 1280px;
        margin: 0 auto;
        padding: 32px 24px;
        display: grid;
        grid-template-columns: 400px 1fr;
        gap: 32px;
        align-items: start;
      }

      /* Cards */
      .card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        overflow: hidden;
        transition: all 0.2s ease;
        box-shadow: var(--shadow-xs);
      }

      .card:hover {
        box-shadow: var(--shadow-sm);
        border-color: var(--primary-200);
      }

      .card-header {
        padding: 24px;
        border-bottom: 1px solid var(--border-light);
        background: var(--gray-50);
      }

      .card-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-primary);
        letter-spacing: -0.025em;
      }

      .card-body {
        padding: 24px;
      }

      /* Bill Summary */
      .bill-summary {
        text-align: center;
        margin-bottom: 32px;
      }

      .bill-label {
        font-size: 14px;
        color: var(--text-tertiary);
        font-weight: 500;
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .bill-total {
        font-size: 48px;
        font-weight: 800;
        color: var(--success-600);
        margin-bottom: 16px;
        letter-spacing: -0.025em;
        line-height: 1;
      }

      /* Buttons */
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 12px 24px;
        border: none;
        border-radius: var(--radius);
        font-size: 14px;
        font-weight: 500;
        font-family: inherit;
        cursor: pointer;
        transition: all 0.2s ease;
        text-decoration: none;
        position: relative;
        overflow: hidden;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .btn-primary {
        background: var(--primary-500);
        color: white;
        box-shadow: var(--shadow-xs);
      }

      .btn-primary:hover:not(:disabled) {
        background: var(--primary-600);
        box-shadow: var(--shadow-sm);
        transform: translateY(-1px);
      }

      .btn-secondary {
        background: var(--surface);
        color: var(--text-secondary);
        border: 1px solid var(--border);
      }

      .btn-secondary:hover:not(:disabled) {
        background: var(--surface-hover);
        border-color: var(--primary-500);
        color: var(--primary-600);
      }

      .btn-danger {
        background: var(--danger-500);
        color: white;
        box-shadow: var(--shadow-xs);
      }

      .btn-danger:hover:not(:disabled) {
        background: var(--danger-600);
        box-shadow: var(--shadow-sm);
      }

      .btn-sm {
        padding: 8px 16px;
        font-size: 13px;
      }

      .btn-full {
        width: 100%;
      }

      /* Items List */
      .items-container {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .item-card {
        background: var(--surface);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        transition: all 0.2s ease;
        overflow: hidden;
      }

      .item-card:hover {
        border-color: var(--primary-200);
        box-shadow: var(--shadow-sm);
      }

      .item-header {
        padding: 20px;
        cursor: pointer;
        user-select: none;
        transition: all 0.2s ease;
      }

      .item-header:hover {
        background: var(--gray-50);
      }

      .item-header.active {
        background: var(--primary-50);
        border-bottom: 1px solid var(--border-light);
      }

      .item-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
      }

      .item-info {
        flex: 1;
        min-width: 0;
      }

      .item-name {
        font-size: 16px;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 4px;
        letter-spacing: -0.025em;
      }

      .item-meta {
        font-size: 13px;
        color: var(--text-tertiary);
        font-weight: 500;
      }

      .item-actions {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .item-price {
        font-size: 18px;
        font-weight: 700;
        color: var(--success-600);
        letter-spacing: -0.025em;
      }

      .chevron {
        width: 20px;
        height: 20px;
        color: var(--text-tertiary);
        transition: transform 0.2s ease;
      }

      .chevron.rotated {
        transform: rotate(180deg);
      }

      .item-details {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
      }

      .item-details.expanded {
        max-height: 600px;
      }

      .item-details-content {
        padding: 24px;
        background: var(--gray-50);
        border-top: 1px solid var(--border-light);
      }

      /* Impact Sections */
      .impact-section {
        margin-bottom: 24px;
      }

      .impact-section:last-child {
        margin-bottom: 0;
      }

      .impact-title {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 16px;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .impact-icon {
        width: 16px;
        height: 16px;
      }

      .carbon-info {
        background: linear-gradient(
          135deg,
          var(--warning-500),
          var(--warning-600)
        );
        color: white;
        border-radius: var(--radius-md);
        padding: 20px;
        margin-bottom: 16px;
        box-shadow: var(--shadow-sm);
      }

      .carbon-amount {
        font-size: 16px;
        font-weight: 700;
        margin-bottom: 4px;
      }

      .carbon-description {
        font-size: 14px;
        opacity: 0.9;
      }

      .alternatives {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .alternative-item {
        background: linear-gradient(
          135deg,
          var(--success-500),
          var(--success-600)
        );
        color: white;
        border-radius: var(--radius-md);
        padding: 20px;
        box-shadow: var(--shadow-sm);
        transition: all 0.2s ease;
      }

      .alternative-item:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
      }

      .alternative-name {
        font-size: 15px;
        font-weight: 600;
        margin-bottom: 4px;
      }

      .alternative-benefit {
        font-size: 13px;
        opacity: 0.9;
        margin-bottom: 16px;
      }

      /* Empty State */
      .empty-state {
        text-align: center;
        padding: 80px 32px;
        color: var(--text-tertiary);
      }

      .empty-state-icon {
        font-size: 48px;
        margin-bottom: 16px;
        opacity: 0.5;
      }

      .empty-state h3 {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-secondary);
        margin-bottom: 8px;
      }

      .empty-state p {
        font-size: 14px;
        color: var(--text-tertiary);
      }

      /* Toast Notifications */
      .toast-container {
        position: fixed;
        top: 24px;
        right: 24px;
        z-index: 100;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .toast {
        background: var(--success-500);
        color: white;
        padding: 16px 20px;
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-lg);
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 14px;
        font-weight: 500;
        opacity: 0;
        transform: translateX(100%);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .toast.show {
        opacity: 1;
        transform: translateX(0);
      }

      .toast-icon {
        width: 20px;
        height: 20px;
      }

      /* Responsive Design */
      @media (max-width: 1024px) {
        .main-container {
          grid-template-columns: 1fr;
          gap: 24px;
          padding: 24px 16px;
        }

        .header-content {
          padding: 0 16px;
        }
      }

      @media (max-width: 768px) {
        .header-content {
          height: 64px;
        }

        .logo {
          font-size: 18px;
        }

        .logo-icon {
          width: 28px;
          height: 28px;
          font-size: 16px;
        }

        .theme-toggle span {
          display: none;
        }

        .bill-total {
          font-size: 36px;
        }

        .card-body {
          padding: 20px;
        }

        .item-header {
          padding: 16px;
        }

        .item-details-content {
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header-content">
        <a href="#" class="logo">
          <div class="logo-icon">üå±</div>
          EcoCart
        </a>

        <div class="header-actions">
          <div class="stat-badge coins">
            <div class="stat-dot warning"></div>
            <span id="coin-count">0</span> Coins
          </div>

          <div class="stat-badge">
            <div class="stat-dot"></div>
            Live Updates
          </div>

          <div class="theme-toggle" onclick="toggleTheme()">
            <svg
              class="theme-icon"
              id="theme-icon"
              fill="currentColor"
              viewBox="0 0 24 24"
              width="16"
              height="16"
            >
              <path
                d="M12 3V1m0 22v-2m9-9h2M1 12h2m15.36-6.36L19.78 4.22M4.22 4.22l1.42 1.42m0 12.72L4.22 19.78m15.56 0l-1.42-1.42M12 7a5 5 0 100 10 5 5 0 000-10z"
              />
            </svg>
            <span>Light</span>
          </div>
        </div>
      </div>
    </header>

    <main class="main-container">
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Bill Summary</h2>
        </div>
        <div class="card-body">
          <div class="bill-summary">
            <div class="bill-label">Total Amount</div>
            <div class="bill-total" id="total-bill">$0.00</div>
          </div>
          <button class="btn btn-primary btn-full" onclick="clearBill()">
            Clear Bill
          </button>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Shopping Cart</h2>
        </div>
        <div class="card-body">
          <div class="items-container" id="items-container">
            <div class="empty-state">
              <div class="empty-state-icon">üõçÔ∏è</div>
              <h3>No items yet</h3>
              <p>Items will appear here as they're added to your cart</p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <div id="toast-container" class="toast-container"></div>

    <script>
      let expandedItems = new Set();

      // Theme management
      function initializeTheme() {
        const savedTheme = localStorage.getItem("theme") || "light";
        document.documentElement.setAttribute("data-theme", savedTheme);
        updateThemeIcon(savedTheme);
      }

      function toggleTheme() {
        const currentTheme =
          document.documentElement.getAttribute("data-theme");
        const newTheme = currentTheme === "dark" ? "light" : "dark";
        document.documentElement.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);
        updateThemeIcon(newTheme);
      }

      function updateThemeIcon(theme) {
        const icon = document.getElementById("theme-icon");
        const text = document.querySelector(".theme-toggle span");

        if (theme === "dark") {
          icon.innerHTML =
            '<path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>';
          text.textContent = "Dark";
        } else {
          icon.innerHTML =
            '<path d="M12 3V1m0 22v-2m9-9h2M1 12h2m15.36-6.36L19.78 4.22M4.22 4.22l1.42 1.42m0 12.72L4.22 19.78m15.56 0l-1.42-1.42M12 7a5 5 0 100 10 5 5 0 000-10z"/>';
          text.textContent = "Light";
        }
      }

      function toTitleCase(str) {
        return str.replace(
          /\w\S*/g,
          (txt) => txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase(),
        );
      }

      function formatRelativeTime(date) {
        const now = new Date();
        const diffInSeconds = Math.floor((now - date) / 1000);

        if (diffInSeconds < 60) return "Just now";
        if (diffInSeconds < 3600)
          return `${Math.floor(diffInSeconds / 60)}m ago`;
        if (diffInSeconds < 86400)
          return `${Math.floor(diffInSeconds / 3600)}h ago`;
        return date.toLocaleDateString();
      }

      function toggleAccordion(itemId) {
        const details = document.getElementById(`details-${itemId}`);
        const chevron = document.getElementById(`chevron-${itemId}`);
        const header = document.getElementById(`header-${itemId}`);

        if (expandedItems.has(itemId)) {
          expandedItems.delete(itemId);
          details.classList.remove("expanded");
          chevron.classList.remove("rotated");
          header.classList.remove("active");
        } else {
          expandedItems.add(itemId);
          details.classList.add("expanded");
          chevron.classList.add("rotated");
          header.classList.add("active");
        }
      }

      function showToast(message) {
        const toastContainer = document.getElementById("toast-container");
        const toast = document.createElement("div");
        toast.classList.add("toast");
        toast.innerHTML = `
                <svg class="toast-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                ${message}
            `;
        toastContainer.appendChild(toast);

        requestAnimationFrame(() => {
          toast.classList.add("show");
        });

        setTimeout(() => {
          toast.classList.remove("show");
          setTimeout(() => toast.remove(), 300);
        }, 3000);
      }

      function updateCoins(amount) {
        const coinCountElement = document.getElementById("coin-count");
        let currentCoins = parseInt(coinCountElement.textContent);
        currentCoins += amount;
        coinCountElement.textContent = currentCoins;
      }

      function generateCarbonInfo(itemName) {
        const carbonData = {
          apple: {
            amount: "0.3 kg CO2",
            description: "Lower carbon footprint compared to imported fruits",
          },
          banana: {
            amount: "0.5 kg CO2",
            description: "Transported from tropical regions",
          },
          beef: {
            amount: "27 kg CO2",
            description: "High carbon footprint due to livestock farming",
          },
          chicken: {
            amount: "6.9 kg CO2",
            description: "Moderate carbon footprint from poultry farming",
          },
          milk: {
            amount: "3.2 kg CO2",
            description: "Dairy production contributes to greenhouse gases",
          },
          bread: {
            amount: "0.9 kg CO2",
            description: "Wheat production and processing",
          },
          rice: {
            amount: "2.7 kg CO2",
            description: "Methane emissions from rice paddies",
          },
          pasta: {
            amount: "1.1 kg CO2",
            description: "Wheat processing and packaging",
          },
        };

        const key = itemName.toLowerCase();
        return (
          carbonData[key] || {
            amount: "1.5 kg CO2",
            description: "Estimated carbon footprint",
          }
        );
      }

      function generateAlternatives(itemName) {
        const alternatives = {
          beef: [
            {
              name: "Plant-based protein",
              benefit: "95% less carbon footprint",
            },
            {
              name: "Locally-sourced chicken",
              benefit: "75% less carbon footprint",
            },
          ],
          milk: [
            { name: "Oat milk", benefit: "80% less carbon footprint" },
            { name: "Almond milk", benefit: "70% less carbon footprint" },
          ],
          banana: [
            {
              name: "Local seasonal fruits",
              benefit: "60% less transportation emissions",
            },
            {
              name: "Organic bananas",
              benefit: "30% less environmental impact",
            },
          ],
          rice: [
            { name: "Quinoa", benefit: "50% less methane emissions" },
            { name: "Local grains", benefit: "40% less transportation impact" },
          ],
        };

        const key = itemName.toLowerCase();
        return (
          alternatives[key] || [
            {
              name: "Organic alternative",
              benefit: "30% less environmental impact",
            },
            {
              name: "Local sourced option",
              benefit: "50% less transportation emissions",
            },
          ]
        );
      }

      async function fetchBill() {
        try {
          const response = await fetch("/bill");
          const data = await response.json();
          console.log("Called fetchBill");

          document.getElementById("total-bill").textContent =
            `$${data.total_bill.toFixed(2)}`;
          document.getElementById("coin-count").textContent = 0;

          const container = document.getElementById("items-container");

          if (data.items.length === 0) {
            container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">üõçÔ∏è</div>
                            <h3>No items yet</h3>
                            <p>Items will appear here as they're added to your cart</p>
                        </div>
                    `;
            return;
          }

          data.items.sort(
            (a, b) => new Date(b[3]).getTime() - new Date(a[3]).getTime(),
          );

          container.innerHTML = data.items
            .map((item) => {
              const itemId = item[0];
              const itemName = toTitleCase(item[1]);
              const itemPrice = item[2];
              const timestamp = new Date(item[3]);
              const isExpanded = expandedItems.has(itemId);

              const carbonInfo = generateCarbonInfo(itemName);
              const alternatives = generateAlternatives(itemName);

              return `
                        <div class="item-card">
                            <div class="item-header ${isExpanded ? "active" : ""}" id="header-${itemId}" onclick="toggleAccordion(${itemId})">
                                <div class="item-content">
                                    <div class="item-info">
                                        <div class="item-name">${itemName}</div>
                                        <div class="item-meta">Added ${formatRelativeTime(timestamp)}</div>
                                    </div>
                                    <div class="item-actions">
                                        <div class="item-price">${itemPrice.toFixed(2)}</div>
                                        <button class="btn btn-danger btn-sm" onclick="event.stopPropagation(); removeItem(${itemId})">
                                            Remove
                                        </button>
                                        <svg class="chevron ${isExpanded ? "rotated" : ""}" id="chevron-${itemId}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                            <div class="item-details ${isExpanded ? "expanded" : ""}" id="details-${itemId}">
                                <div class="item-details-content">
                                    <div class="impact-section">
                                        <div class="impact-title">
                                            <svg class="impact-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/>
                                            </svg>
                                            Carbon Footprint
                                        </div>
                                        <div class="carbon-info">
                                            <div class="carbon-amount">${carbonInfo.amount}</div>
                                            <div class="carbon-description">${carbonInfo.description}</div>
                                        </div>
                                    </div>
                                    <div class="impact-section">
                                        <div class="impact-title">
                                            <svg class="impact-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                            </svg>
                                            Sustainable Alternatives
                                        </div>
                                        <div class="alternatives">
                                            ${alternatives
                                              .map(
                                                (alt) => `
                                                <div class="alternative-item">
                                                    <div class="alternative-name">${alt.name}</div>
                                                    <div class="alternative-benefit">${alt.benefit}</div>
                                                    <button class="btn btn-secondary btn-sm" onclick="showToast('üéâ +10 coins earned!'); updateCoins(10);">
                                                        Choose This Alternative
                                                    </button>
                                                </div>
                                            `,
                                              )
                                              .join("")}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
            })
            .join("");
        } catch (error) {
          console.error("Error fetching bill:", error);
        }
      }

      async function clearBill() {
        try {
          expandedItems.clear();
          await fetch("/bill/clear", { method: "POST" });
          fetchBill();
        } catch (error) {
          console.error("Error clearing bill:", error);
        }
      }

      async function removeItem(itemId) {
        try {
          expandedItems.delete(itemId);
          await fetch(`/bill/remove/${itemId}`, { method: "POST" });
          fetchBill();
        } catch (error) {
          console.error("Error removing item:", error);
        }
      }

      // Initialize
      initializeTheme();
      fetchBill();
      setInterval(fetchBill, 2000);
    </script>
  </body>
</html>
